services:
  - type: web
    name: fliesen-showroom
    runtime: python
    pythonVersion: "3.12.3"
    buildCommand: "pip install -r requirements.txt"
    startCommand: "gunicorn wsgi:app"
    envVars:
      - key: DATABASE_URL
        sync: false
      - key: DB_SCHEMA
        sync: false
      - key: SECRET_KEY
        sync: false
      - key: OPENAI_API_KEY
        sync: false

  # Automatic blog generation: Mon, Wed, Fri at 8:00 AM UTC
  - type: cron
    name: blog-auto-generate
    runtime: python
    pythonVersion: "3.12.3"
    schedule: "0 8 * * 1,3,5"
    buildCommand: "pip install -r requirements.txt"
    startCommand: "flask generate-blog --count 1"
    envVars:
      - key: DATABASE_URL
        sync: false
      - key: OPENAI_API_KEY
        sync: false
      - key: SECRET_KEY
        sync: false

  # Publish scheduled posts: every 30 minutes
  - type: cron
    name: blog-publisher
    runtime: python
    pythonVersion: "3.12.3"
    schedule: "*/30 * * * *"
    buildCommand: "pip install -r requirements.txt"
    startCommand: "flask publish-scheduled"
    envVars:
      - key: DATABASE_URL
        sync: false
      - key: SECRET_KEY
        sync: false
